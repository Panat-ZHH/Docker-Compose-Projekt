FROM mariadb:latest

# Copy custom configuration if needed
# COPY my.cnf /etc/mysql/conf.d/

# Environment variables set during build time
ENV MYSQL_ROOT_PASSWORD=root
ENV MYSQL_DATABASE=Soundify
ENV MYSQL_USER=Soundify
ENV MYSQL_PASSWORD=Soundify

# Copy initialization SQL script
COPY init.sql /docker-entrypoint-initdb.d/

# Healthcheck to verify database is working
HEALTHCHECK --interval=10s --timeout=20s --retries=10 --start-period=30s \
    CMD mysql -h localhost -uroot -proot -e "SELECT 1" || exit 1

# Expose MySQL port
EXPOSE 3306
